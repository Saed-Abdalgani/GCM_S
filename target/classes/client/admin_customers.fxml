<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="client.boundary.AdminCustomersScreen"
            style="-fx-background-color: #0f0f23;">
    
    <!-- Header -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: linear-gradient(to right, #e74c3c, #c0392b); -fx-padding: 15 25;">
            <Button fx:id="backBtn" text="â† Back" onAction="#handleBack"
                    style="-fx-background-color: rgba(255,255,255,0.2); -fx-text-fill: white; -fx-font-size: 12px; -fx-padding: 8 15; -fx-background-radius: 15;"/>
            <Label text="ðŸ‘¥ Customer Management" style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: bold;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="adminLabel" text="Manager View" style="-fx-text-fill: rgba(255,255,255,0.9); -fx-font-size: 14px;"/>
        </HBox>
    </top>
    
    <!-- Main Content -->
    <center>
        <VBox spacing="20" style="-fx-padding: 25;">
            
            <!-- Stats Cards -->
            <HBox spacing="20">
                <VBox alignment="CENTER" spacing="5" prefWidth="200" prefHeight="100"
                      style="-fx-background-color: linear-gradient(to bottom right, #667eea, #764ba2); -fx-background-radius: 15; -fx-padding: 20;">
                    <Label fx:id="totalCustomersLabel" text="0" style="-fx-text-fill: white; -fx-font-size: 36px; -fx-font-weight: bold;"/>
                    <Label text="Total Customers" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 14px;"/>
                </VBox>
                <VBox alignment="CENTER" spacing="5" prefWidth="200" prefHeight="100"
                      style="-fx-background-color: linear-gradient(to bottom right, #27ae60, #1e8449); -fx-background-radius: 15; -fx-padding: 20;">
                    <Label fx:id="totalRevenueLabel" text="$0" style="-fx-text-fill: white; -fx-font-size: 36px; -fx-font-weight: bold;"/>
                    <Label text="Total Revenue" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 14px;"/>
                </VBox>
                <VBox alignment="CENTER" spacing="5" prefWidth="200" prefHeight="100"
                      style="-fx-background-color: linear-gradient(to bottom right, #f39c12, #d68910); -fx-background-radius: 15; -fx-padding: 20;">
                    <Label fx:id="avgSpendLabel" text="$0" style="-fx-text-fill: white; -fx-font-size: 36px; -fx-font-weight: bold;"/>
                    <Label text="Avg. per Customer" style="-fx-text-fill: rgba(255,255,255,0.8); -fx-font-size: 14px;"/>
                </VBox>
            </HBox>
            
            <!-- Search and Actions -->
            <HBox spacing="15" alignment="CENTER_LEFT">
                <TextField fx:id="searchField" promptText="ðŸ” Search customers..."
                           prefWidth="300"
                           style="-fx-background-color: #1a1a2e; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10; -fx-background-radius: 5;"/>
                <Button text="Search" onAction="#handleSearch"
                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="ðŸ”„ Refresh" onAction="#handleRefresh"
                        style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20; -fx-background-radius: 5;"/>
            </HBox>
            
            <!-- Customers Table -->
            <VBox spacing="10" VBox.vgrow="ALWAYS">
                <Label text="All Customers" style="-fx-text-fill: white; -fx-font-size: 18px; -fx-font-weight: bold;"/>
                
                <TableView fx:id="customersTable" VBox.vgrow="ALWAYS"
                           style="-fx-background-color: #1a1a2e; -fx-control-inner-background: #1a1a2e;">
                    <columns>
                        <TableColumn fx:id="usernameCol" text="Username" prefWidth="150"/>
                        <TableColumn fx:id="emailCol" text="Email" prefWidth="200"/>
                        <TableColumn fx:id="phoneCol" text="Phone" prefWidth="130"/>
                        <TableColumn fx:id="purchasesCol" text="Purchases" prefWidth="90"/>
                        <TableColumn fx:id="subscriptionsCol" text="Subs" prefWidth="70"/>
                        <TableColumn fx:id="spentCol" text="Total Spent" prefWidth="120"/>
                        <TableColumn fx:id="registeredCol" text="Registered" prefWidth="120"/>
                        <TableColumn fx:id="statusCol" text="Status" prefWidth="80"/>
                        <TableColumn fx:id="actionCol" text="Action" prefWidth="100"/>
                    </columns>
                    <placeholder>
                        <Label text="No customers found" style="-fx-text-fill: #666;"/>
                    </placeholder>
                </TableView>
            </VBox>
            
            <!-- Customer Purchases Panel (shown when a customer is selected) -->
            <VBox fx:id="purchasesPanel" spacing="10" visible="false" managed="false"
                  style="-fx-background-color: #1a1a2e; -fx-background-radius: 10; -fx-padding: 20;">
                <HBox alignment="CENTER_LEFT" spacing="15">
                    <Label fx:id="selectedCustomerLabel" text="Customer Purchases" 
                           style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="âœ• Close" onAction="#closePurchasesPanel"
                            style="-fx-background-color: #666; -fx-text-fill: white; -fx-font-size: 12px; -fx-padding: 5 15;"/>
                </HBox>
                
                <TableView fx:id="purchasesTable" prefHeight="200"
                           style="-fx-background-color: #16213e; -fx-control-inner-background: #16213e;">
                    <columns>
                        <TableColumn fx:id="pCityCol" text="City" prefWidth="180"/>
                        <TableColumn fx:id="pTypeCol" text="Type" prefWidth="120"/>
                        <TableColumn fx:id="pPriceCol" text="Price" prefWidth="100"/>
                        <TableColumn fx:id="pDateCol" text="Date" prefWidth="130"/>
                        <TableColumn fx:id="pStatusCol" text="Status" prefWidth="100"/>
                    </columns>
                </TableView>
            </VBox>
            
        </VBox>
    </center>
    
    <!-- Footer -->
    <bottom>
        <HBox alignment="CENTER" spacing="20" style="-fx-background-color: #1a1a2e; -fx-padding: 10;">
            <Label text="Admin Panel" style="-fx-text-fill: #666; -fx-font-size: 11px;"/>
            <Label text="â€¢" style="-fx-text-fill: #666;"/>
            <Label fx:id="statusLabel" text="Ready" style="-fx-text-fill: #27ae60; -fx-font-size: 11px;"/>
        </HBox>
    </bottom>
</BorderPane>
